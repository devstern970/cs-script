<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>ScriptParser Class</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="ScriptParser class" /><meta name="System.Keywords" content="CSScriptLib.ScriptParser class" /><meta name="Microsoft.Help.F1" content="CSScriptLib.ScriptParser" /><meta name="Microsoft.Help.Id" content="T:CSScriptLib.ScriptParser" /><meta name="Description" content="Class that manages parsing the main and all imported (if any) C# Script files" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="CSScriptLib" /><meta name="file" content="4018c1a4-971a-5b4b-069b-fbaa34080719" /><meta name="guid" content="4018c1a4-971a-5b4b-069b-fbaa34080719" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">A Sandcastle Documented Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/dd1d21fd-0687-3709-ad9e-fb2c04b07fdd.htm" title="A Sandcastle Documented Class Library" tocid="roottoc">A Sandcastle Documented Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/3bca438b-6a3b-acb6-218a-f07ec3aa462e.htm" title="CSScriptLib" tocid="3bca438b-6a3b-acb6-218a-f07ec3aa462e">CSScriptLib</a></div><div class="toclevel1 current" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/4018c1a4-971a-5b4b-069b-fbaa34080719.htm" title="ScriptParser Class" tocid="4018c1a4-971a-5b4b-069b-fbaa34080719">ScriptParser Class</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/d324ccd6-8537-835c-22cd-3f8ddc805003.htm" title="ScriptParser Constructor " tocid="d324ccd6-8537-835c-22cd-3f8ddc805003">ScriptParser Constructor </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/8b424a0d-0829-eafb-aba4-d930e3844528.htm" title="ScriptParser Properties" tocid="8b424a0d-0829-eafb-aba4-d930e3844528">ScriptParser Properties</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/4848ef04-ca5c-662d-9434-e2d5227e7e0a.htm" title="ScriptParser Methods" tocid="4848ef04-ca5c-662d-9434-e2d5227e7e0a">ScriptParser Methods</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/e2dba48b-0f44-ad18-642f-db95ab7ad776.htm" title="ScriptParser Fields" tocid="e2dba48b-0f44-ad18-642f-db95ab7ad776">ScriptParser Fields</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>ScriptParser Class</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Class that manages parsing the main and all imported (if any) C# Script files
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="ID0RBSection" class="collapsibleSection"><a href="https://docs.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">System<span id="LST6258A520_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6258A520_0?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><br />  <span class="selflink">CSScriptLib<span id="LST6258A520_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6258A520_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ScriptParser</span><br /></div><p> </p>
    <strong>Namespace:</strong> 
   <a href="3bca438b-6a3b-acb6-218a-f07ec3aa462e.htm">CSScriptLib</a><br />
    <strong>Assembly:</strong>
   CSScriptLib (in CSScriptLib.dll) Version: 4.2.0.0+30e756f5d1f8de034edc7e52892cd2261d20b452<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EACA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EACA');return false;" title="Copy">Copy</a></div></div><div id="ID1EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">ScriptParser</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EACA");</script></div><p>The <span class="selflink">ScriptParser</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Constructors</span></div><div id="ID3RBSection" class="collapsibleSection"><table class="members" id="constructorList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="8d0c657b-fe54-ada4-ac1a-f25481f1a204.htm">ScriptParser(String)</a></td><td><div class="summary">
            Constructor.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="bc7f4b1b-984b-75ba-5458-118f238100ef.htm">ScriptParser(String, <span id="LST6258A520_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6258A520_2?cpp=array&lt;");</script>String<span id="LST6258A520_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6258A520_3?cpp=&gt;|cs=[]|vb=()|nu=[]|fs=[]");</script>)</a></td><td><div class="summary">
            Constructor.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="7e97ab80-cbe9-b374-1302-21fb090912b1.htm">ScriptParser(String, <span id="LST6258A520_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6258A520_4?cpp=array&lt;");</script>String<span id="LST6258A520_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6258A520_5?cpp=&gt;|cs=[]|vb=()|nu=[]|fs=[]");</script>, Boolean)</a></td><td><div class="summary">
            Constructor.
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Properties</span></div><div id="ID4RBSection" class="collapsibleSection"><table class="members" id="propertyList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="272548d1-eeec-59e0-ddb4-cb6db070eef7.htm">CompilerOptions</a></td><td><div class="summary">
            Collection of compiler options
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="4942af1d-5914-c8ff-2a51-135912a2c75e.htm">FilesToCompile</a></td><td><div class="summary">
            Collection of the files to be compiled (including dependent scripts)
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="1c59e15b-b7fa-9d2b-8593-33af01bb4f98.htm">IgnoreNamespaces</a></td><td><div class="summary">
            Collection of namespaces, which if found in code, should not be resolved into referenced assembly.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="bd30072c-6288-c430-d167-fa644baaf0a1.htm">ImportedFiles</a></td><td><div class="summary">
            Collection of the imported files (dependent scripts)
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="32ad3699-448c-dc1b-a8a2-e2f87df42e62.htm">IsWebApp</a></td><td><div class="summary">
            Gets a value indicating whether the script being parsed is a web application script.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="5375351e-da45-d976-0d61-76d746ad6311.htm">Packages</a></td><td><div class="summary">
            Collection of the NuGet packages
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="1b03e7ca-febe-3cc6-6746-e938d7050417.htm">Precompilers</a></td><td><div class="summary">
            Precompilers specified in the primary script file.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="b49548e6-af52-4a1e-1213-568e30741213.htm">ReferencedAssemblies</a></td><td><div class="summary">
            Collection of referenced assemblies. All assemblies are referenced either from command-line, code or resolved from referenced namespaces.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="25f4d58e-c7ee-f79a-a7a4-d36796740c90.htm">ReferencedNamespaces</a></td><td><div class="summary">
            Collection of namespaces referenced from code (including those referenced in dependent scripts)
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="57253c3f-9146-0ca6-6d37-8d637627e702.htm">ReferencedResources</a></td><td><div class="summary">
            Collection of resource files referenced from code
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="37b2b373-e5ff-dad2-d24c-0fe9b10a390a.htm">ScriptPath</a></td><td><div class="summary">
            The path of the parsed script.
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="ID5RBSection" class="collapsibleSection"><table class="members" id="methodList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="949ff6b5-d500-f1b5-ee17-4c3077dcaf82.htm">AgregateReferences</a></td><td><div class="summary">
             Aggregates the references from the script and its imported scripts. It is a logical equivalent of CSExecutor.AggregateReferencedAssemblies
             but optimized for later .NET versions (e.g LINQ) and completely decoupled. Thus it has no dependencies on internal state
             (e.g. settings, options.shareHostAssemblies).
             <p>It is the method to call for generating list of ref asms as part of the project info.</p></div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="b00547e5-1289-f7d4-4abe-efa0f0411f98.htm">DeleteImportedFiles</a></td><td><div class="summary">
            Deletes imported scripts as a cleanup operation
            </div></td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://docs.microsoft.com/dotnet/api/system.object.equals#System_Object_Equals_System_Object_" target="_blank" rel="noopener noreferrer">Equals</a></td><td><div class="summary">Determines whether the specified object is equal to the current object.</div> (Inherited from <a href="https://docs.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>.)</td></tr><tr data="protected;inherited;notNetfw;"><td><img src="../icons/protmethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="https://docs.microsoft.com/dotnet/api/system.object.finalize#System_Object_Finalize" target="_blank" rel="noopener noreferrer">Finalize</a></td><td><div class="summary">Allows an object to try to free resources and perform other cleanup operations before it is reclaimed by garbage collection.</div> (Inherited from <a href="https://docs.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>.)</td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="f6c9aff7-3f15-0b9d-a929-5e5f02fe18bb.htm">GetContext</a></td><td><div class="summary">
            Gets the script parsing context. This object is effectively a parsing result.
            </div></td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://docs.microsoft.com/dotnet/api/system.object.gethashcode#System_Object_GetHashCode" target="_blank" rel="noopener noreferrer">GetHashCode</a></td><td><div class="summary">Serves as the default hash function.</div> (Inherited from <a href="https://docs.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>.)</td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://docs.microsoft.com/dotnet/api/system.object.gettype#System_Object_GetType" target="_blank" rel="noopener noreferrer">GetType</a></td><td><div class="summary">Gets the <a href="https://docs.microsoft.com/dotnet/api/system.type" target="_blank" rel="noopener noreferrer">Type</a> of the current instance.</div> (Inherited from <a href="https://docs.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>.)</td></tr><tr data="protected;inherited;notNetfw;"><td><img src="../icons/protmethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="https://docs.microsoft.com/dotnet/api/system.object.memberwiseclone#System_Object_MemberwiseClone" target="_blank" rel="noopener noreferrer">MemberwiseClone</a></td><td><div class="summary">Creates a shallow copy of the current <a href="https://docs.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>.</div> (Inherited from <a href="https://docs.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>.)</td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="b48c34e1-fcba-e84d-a45f-91dded0b5d4a.htm">ProcessImportedScript</a></td><td><div class="summary">
            Processes the imported script. Processing involves lookup for 'static Main' and renaming it so it does not
            interfere with the 'static Main' of the primary script. After renaming is done the new content is saved in the
            CS-Script cache and the new file location is returned. The saved file can be used late as an "included script".
            This technique can be from 'precompiler' scripts.
            <p>If the script file does not require renaming (static Main is not present) the method returns the
            original script file location.</p></div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="ad221b9d-b63d-a84f-1342-d679419a4739.htm">ResolvePackages</a></td><td><div class="summary">
            Resolves the NuGet packages into assemblies to be referenced by the script.
            <p>If the package was never installed/downloaded yet CS-Script runtime will try to download it.</p><p>CS-Script will also analyze the installed package structure in try to reference compatible assemblies
            from the package.</p></div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="029486a5-618c-7793-27a9-9f63db5235c1.htm">SaveImportedScripts</a></td><td><div class="summary">
            Saves all imported scripts in the temporary location.
            </div></td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://docs.microsoft.com/dotnet/api/system.object.tostring#System_Object_ToString" target="_blank" rel="noopener noreferrer">ToString</a></td><td><div class="summary">Returns a string that represents the current object.</div> (Inherited from <a href="https://docs.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>.)</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID6RB')" onkeypress="SectionExpandCollapse_CheckKey('ID6RB', event)" tabindex="0"><img id="ID6RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Fields</span></div><div id="ID6RBSection" class="collapsibleSection"><table class="members" id="fieldList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubfield.gif" alt="Public field" title="Public field" /></td><td><a href="24555c25-8468-eaea-f190-8f7b90153cf9.htm">apartmentState</a></td><td><div class="summary">
            ApartmentState of a script during the execution (default: ApartmentState.Unknown)
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubfield.gif" alt="Public field" title="Public field" /></td><td><a href="d033e117-7b51-76c3-6838-9e0adf63a9a7.htm">SearchDirs</a></td><td><div class="summary">
            CS-Script SearchDirectories specified in the parsed script or its dependent scripts.
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID7RB')" onkeypress="SectionExpandCollapse_CheckKey('ID7RB', event)" tabindex="0"><img id="ID7RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID7RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="3bca438b-6a3b-acb6-218a-f07ec3aa462e.htm">CSScriptLib Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>